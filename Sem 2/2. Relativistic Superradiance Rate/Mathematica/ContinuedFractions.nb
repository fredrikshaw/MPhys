(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[     19792,        570]
NotebookOptionsPosition[     19430,        556]
NotebookOutlinePosition[     19832,        572]
CellTagsIndexPosition[     19789,        569]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"G", "=", "1"}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rPlus", "[", 
    RowBox[{"M_", ",", "aTilde_"}], "]"}], ":=", 
   RowBox[{"G", " ", "M", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"1", "-", 
        RowBox[{"aTilde", "^", "2"}]}], "]"}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"rMinus", "[", 
     RowBox[{"M_", ",", "aTilde_"}], "]"}], ":=", 
    RowBox[{"G", " ", "M", " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"1", "-", 
         RowBox[{"aTilde", "^", "2"}]}], "]"}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Remove", " ", "internal", " ", "SetPrecision"}], "\[LongDash]", 
    RowBox[{
    "let", " ", "precision", " ", "flow", " ", "from", " ", "caller"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"q", "[", 
     RowBox[{"\[Mu]_", ",", 
      RowBox[{"\[Omega]_", "?", "NumericQ"}]}], "]"}], ":=", 
    RowBox[{"-", 
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"\[Mu]", "^", "2"}], "-", 
       RowBox[{"\[Omega]", "^", "2"}]}], "]"}]}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Omega]Tilde", "[", 
    RowBox[{"M_", ",", 
     RowBox[{"\[Omega]_", "?", "NumericQ"}]}], "]"}], ":=", 
   RowBox[{"G", " ", "M", " ", "\[Omega]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"b", "[", "aTilde_", "]"}], ":=", 
   RowBox[{"Sqrt", "[", 
    RowBox[{"1", "-", 
     RowBox[{"aTilde", "^", "2"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"qTilde", "[", 
     RowBox[{"M_", ",", 
      RowBox[{"qval_", "?", "NumericQ"}]}], "]"}], ":=", 
    RowBox[{"G", " ", "M", " ", "qval"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalLambda]lm\[CapitalLambda]lm", "[", 
      RowBox[{"l_", ",", "m_"}], "]"}], "[", 
     RowBox[{
      RowBox[{"\[Omega]_", "?", "NumericQ"}], ",", "aTilde_", ",", "M_", ",", 
      "\[Mu]_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"l", 
      RowBox[{"(", 
       RowBox[{"l", "+", "1"}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"aTilde", "^", "2"}], " ", 
      RowBox[{"G", "^", "2"}], " ", 
      RowBox[{"M", "^", "2"}], " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Omega]", "^", "2"}], "-", 
         RowBox[{"\[Mu]", "^", "2"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", "l"}], "+", "1"}], ")"}]}]}]}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"c0", "[", 
     RowBox[{"M_", ",", 
      RowBox[{"\[Omega]_", "?", "NumericQ"}], ",", "aTilde_", ",", "m_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Omega]T", ",", "bval"}], "}"}], ",", 
      RowBox[{
       RowBox[{"\[Omega]T", "=", 
        RowBox[{"\[Omega]Tilde", "[", 
         RowBox[{"M", ",", "\[Omega]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"bval", "=", 
        RowBox[{"b", "[", "aTilde", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"1", "-", 
        RowBox[{"2", "I", "*", "\[Omega]T"}], "-", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"2", "I"}], ")"}], "/", "bval"}], "*", 
         RowBox[{"(", 
          RowBox[{"\[Omega]T", "-", 
           RowBox[{"aTilde", "*", 
            RowBox[{"m", "/", "2"}]}]}], ")"}]}]}]}]}], "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"c1", "[", 
     RowBox[{"M_", ",", 
      RowBox[{"\[Omega]_", "?", "NumericQ"}], ",", "aTilde_", ",", "m_", ",", 
      "\[Mu]_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Omega]T", ",", "qval", ",", "qT", ",", "bval"}], "}"}], ",", 
      RowBox[{
       RowBox[{"\[Omega]T", "=", 
        RowBox[{"\[Omega]Tilde", "[", 
         RowBox[{"M", ",", "\[Omega]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"qval", "=", 
        RowBox[{"q", "[", 
         RowBox[{"\[Mu]", ",", "\[Omega]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"qT", "=", 
        RowBox[{"qTilde", "[", 
         RowBox[{"M", ",", "qval"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"bval", "=", 
        RowBox[{"b", "[", "aTilde", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"-", "4"}], "+", 
        RowBox[{"4", "I", 
         RowBox[{"(", 
          RowBox[{"\[Omega]T", "-", 
           RowBox[{"I", " ", "qT", 
            RowBox[{"(", 
             RowBox[{"1", "+", "bval"}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"4", "I"}], ")"}], "/", "bval"}], "*", 
         RowBox[{"(", 
          RowBox[{"\[Omega]T", "-", 
           RowBox[{"aTilde", "*", 
            RowBox[{"m", "/", "2"}]}]}], ")"}]}], "-", 
        RowBox[{"2", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Omega]T", "^", "2"}], "+", 
            RowBox[{"qT", "^", "2"}]}], ")"}], "/", "qT"}]}]}]}]}], "]"}]}], 
   ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"c2", "[", 
     RowBox[{"M_", ",", 
      RowBox[{"\[Omega]_", "?", "NumericQ"}], ",", "aTilde_", ",", "m_", ",", 
      "\[Mu]_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Omega]T", ",", "qval", ",", "qT", ",", "bval"}], "}"}], ",", 
      RowBox[{
       RowBox[{"\[Omega]T", "=", 
        RowBox[{"\[Omega]Tilde", "[", 
         RowBox[{"M", ",", "\[Omega]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"qval", "=", 
        RowBox[{"q", "[", 
         RowBox[{"\[Mu]", ",", "\[Omega]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"qT", "=", 
        RowBox[{"qTilde", "[", 
         RowBox[{"M", ",", "qval"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"bval", "=", 
        RowBox[{"b", "[", "aTilde", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"3", "-", 
        RowBox[{"2", "I", "*", "\[Omega]T"}], "-", 
        RowBox[{"2", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"qT", "^", "2"}], "-", 
            RowBox[{"\[Omega]T", "^", "2"}]}], ")"}], "/", "qT"}]}], "-", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"2", "I"}], ")"}], "/", "bval"}], "*", 
         RowBox[{"(", 
          RowBox[{"\[Omega]T", "-", 
           RowBox[{"aTilde", "*", 
            RowBox[{"m", "/", "2"}]}]}], ")"}]}]}]}]}], "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"c3", "[", 
      RowBox[{"l_", ",", "m_"}], "]"}], "[", 
     RowBox[{"M_", ",", 
      RowBox[{"\[Omega]_", "?", "NumericQ"}], ",", "aTilde_", ",", "\[Mu]_"}],
      "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\[Omega]T", ",", "qval", ",", "qT", ",", "bval", ",", 
        "\[CapitalLambda]"}], "}"}], ",", 
      RowBox[{
       RowBox[{"\[Omega]T", "=", 
        RowBox[{"\[Omega]Tilde", "[", 
         RowBox[{"M", ",", "\[Omega]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"qval", "=", 
        RowBox[{"q", "[", 
         RowBox[{"\[Mu]", ",", "\[Omega]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"qT", "=", 
        RowBox[{"qTilde", "[", 
         RowBox[{"M", ",", "qval"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"bval", "=", 
        RowBox[{"b", "[", "aTilde", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[CapitalLambda]", "=", 
        RowBox[{
         RowBox[{"\[CapitalLambda]lm\[CapitalLambda]lm", "[", 
          RowBox[{"l", ",", "m"}], "]"}], "[", 
         RowBox[{"\[Omega]", ",", "aTilde", ",", "M", ",", "\[Mu]"}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"2", "I", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Omega]T", "-", 
             RowBox[{"I", " ", "qT"}]}], ")"}], "^", "3"}], "/", "qT"}]}], "+", 
        RowBox[{"2", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\[Omega]T", "-", 
            RowBox[{"I", " ", "qT"}]}], ")"}], "^", "2"}], "*", "bval"}], "+", 
        RowBox[{
         RowBox[{"qT", "^", "2"}], "*", 
         RowBox[{"aTilde", "^", "2"}]}], "+", 
        RowBox[{"2", "I", " ", "qT", " ", "aTilde", " ", "m"}], "-", 
        "\[CapitalLambda]", "-", "1", "-", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\[Omega]T", "-", 
            RowBox[{"I", " ", "qT"}]}], ")"}], "^", "2"}], "/", "qT"}], "+", 
        RowBox[{"2", "qT", "*", "bval"}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"2", "I"}], ")"}], "/", "bval"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"\[Omega]T", "-", 
               RowBox[{"I", " ", "qT"}]}], ")"}], "^", "2"}], "/", "qT"}], "+",
            "1"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{"\[Omega]T", "-", 
           RowBox[{"aTilde", "*", 
            RowBox[{"m", "/", "2"}]}]}], ")"}]}]}]}]}], "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"c4", "[", 
     RowBox[{"M_", ",", 
      RowBox[{"\[Omega]_", "?", "NumericQ"}], ",", "aTilde_", ",", "m_", ",", 
      "\[Mu]_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Omega]T", ",", "qval", ",", "qT", ",", "bval"}], "}"}], ",", 
      RowBox[{
       RowBox[{"\[Omega]T", "=", 
        RowBox[{"\[Omega]Tilde", "[", 
         RowBox[{"M", ",", "\[Omega]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"qval", "=", 
        RowBox[{"q", "[", 
         RowBox[{"\[Mu]", ",", "\[Omega]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"qT", "=", 
        RowBox[{"qTilde", "[", 
         RowBox[{"M", ",", "qval"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"bval", "=", 
        RowBox[{"b", "[", "aTilde", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\[Omega]T", "-", 
            RowBox[{"I", " ", "qT"}]}], ")"}], "^", "4"}], "/", 
         RowBox[{"qT", "^", "2"}]}], "+", 
        RowBox[{"2", "I", "*", "\[Omega]T", "*", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Omega]T", "-", 
             RowBox[{"I", " ", "qT"}]}], ")"}], "^", "2"}], "/", 
          RowBox[{"qT", "^", "2"}]}]}], "-", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"2", "I"}], ")"}], "/", "bval"}], "*", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Omega]T", "-", 
             RowBox[{"I", " ", "qT"}]}], ")"}], "^", "2"}], "/", "qT"}], "*", 
         RowBox[{"(", 
          RowBox[{"\[Omega]T", "-", 
           RowBox[{"aTilde", "*", 
            RowBox[{"m", "/", "2"}]}]}], ")"}]}]}]}]}], "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[Alpha]", "[", "n_", "]"}], "[", 
     RowBox[{"l_", ",", "m_", ",", "M_", ",", 
      RowBox[{"\[Omega]_", "?", "NumericQ"}], ",", "aTilde_", ",", "\[Mu]_"}],
      "]"}], ":=", 
    RowBox[{
     RowBox[{"n", "^", "2"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"c0", "[", 
         RowBox[{"M", ",", "\[Omega]", ",", "aTilde", ",", "m"}], "]"}], "+", 
        "1"}], ")"}], "*", "n"}], "+", 
     RowBox[{"c0", "[", 
      RowBox[{"M", ",", "\[Omega]", ",", "aTilde", ",", "m"}], "]"}]}]}], 
   ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[Beta]", "[", "n_", "]"}], "[", 
     RowBox[{"l_", ",", "m_", ",", "M_", ",", 
      RowBox[{"\[Omega]_", "?", "NumericQ"}], ",", "aTilde_", ",", "\[Mu]_"}],
      "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], 
      RowBox[{"n", "^", "2"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"c1", "[", 
         RowBox[{
         "M", ",", "\[Omega]", ",", "aTilde", ",", "m", ",", "\[Mu]"}], "]"}],
         "+", "2"}], ")"}], "*", "n"}], "+", 
     RowBox[{
      RowBox[{"c3", "[", 
       RowBox[{"l", ",", "m"}], "]"}], "[", 
      RowBox[{"M", ",", "\[Omega]", ",", "aTilde", ",", "\[Mu]"}], "]"}]}]}], 
   ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[Gamma]", "[", "n_", "]"}], "[", 
     RowBox[{"l_", ",", "m_", ",", "M_", ",", 
      RowBox[{"\[Omega]_", "?", "NumericQ"}], ",", "aTilde_", ",", "\[Mu]_"}],
      "]"}], ":=", 
    RowBox[{
     RowBox[{"n", "^", "2"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"c2", "[", 
         RowBox[{
         "M", ",", "\[Omega]", ",", "aTilde", ",", "m", ",", "\[Mu]"}], "]"}],
         "-", "3"}], ")"}], "*", "n"}], "+", 
     RowBox[{"c4", "[", 
      RowBox[{"M", ",", "\[Omega]", ",", "aTilde", ",", "m", ",", "\[Mu]"}], 
      "]"}]}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ContinuedFractionF", "[", 
     RowBox[{
     "l_", ",", "m_", ",", "M_", ",", "\[Omega]_", ",", "aTilde_", ",", 
      "\[Mu]_", ",", "Nmax_", ",", 
      RowBox[{"prec_", ":", "50"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\[Alpha]fun", ",", "\[Beta]fun", ",", "\[Gamma]fun", ",", "fvals", ",",
         "n"}], "}"}], ",", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"$MinPrecision", "=", "prec"}], "}"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Alpha]fun", "[", "k_", "]"}], ":=", 
          RowBox[{
           RowBox[{"\[Alpha]", "[", "k", "]"}], "[", 
           RowBox[{
           "l", ",", "m", ",", "M", ",", "\[Omega]", ",", "aTilde", ",", 
            "\[Mu]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\[Beta]fun", "[", "k_", "]"}], ":=", 
          RowBox[{
           RowBox[{"\[Beta]", "[", "k", "]"}], "[", 
           RowBox[{
           "l", ",", "m", ",", "M", ",", "\[Omega]", ",", "aTilde", ",", 
            "\[Mu]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\[Gamma]fun", "[", "k_", "]"}], ":=", 
          RowBox[{
           RowBox[{"\[Gamma]", "[", "k", "]"}], "[", 
           RowBox[{
           "l", ",", "m", ",", "M", ",", "\[Omega]", ",", "aTilde", ",", 
            "\[Mu]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"fvals", "[", "Nmax", "]"}], "=", "0"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"n", "=", 
            RowBox[{"Nmax", "-", "1"}]}], ",", 
           RowBox[{"n", ">=", "0"}], ",", 
           RowBox[{"n", "--"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"fvals", "[", "n", "]"}], "=", 
             RowBox[{
              RowBox[{"\[Gamma]fun", "[", 
               RowBox[{"n", "+", "1"}], "]"}], "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[Beta]fun", "[", 
                 RowBox[{"n", "+", "1"}], "]"}], "-", 
                RowBox[{
                 RowBox[{"\[Alpha]fun", "[", 
                  RowBox[{"n", "+", "1"}], "]"}], "*", 
                 RowBox[{"fvals", "[", 
                  RowBox[{"n", "+", "1"}], "]"}]}]}], ")"}]}]}], ";"}]}], 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\[Beta]fun", "[", "0", "]"}], "-", 
          RowBox[{
           RowBox[{"\[Alpha]fun", "[", "0", "]"}], "*", 
           RowBox[{"fvals", "[", "0", "]"}]}]}]}]}], "]"}]}], "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SuperradiantMode", "[", 
     RowBox[{
     "l_", ",", "m_", ",", "M_", ",", "aTilde_", ",", "\[Mu]_", ",", 
      "\[Omega]Guess_", ",", 
      RowBox[{"Nmax_", ":", "100"}], ",", 
      RowBox[{"prec_", ":", "60"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "sol", "}"}], ",", 
      RowBox[{
       RowBox[{"sol", "=", 
        RowBox[{"FindRoot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ContinuedFractionF", "[", 
            RowBox[{
            "l", ",", "m", ",", "M", ",", "\[Omega]", ",", "aTilde", ",", 
             "\[Mu]", ",", "Nmax", ",", "prec"}], "]"}], "==", "0"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Omega]", ",", 
            RowBox[{"SetPrecision", "[", 
             RowBox[{"\[Omega]Guess", ",", "prec"}], "]"}]}], "}"}], ",", 
          RowBox[{"WorkingPrecision", "->", "prec"}], ",", 
          RowBox[{"AccuracyGoal", "->", "10"}], ",", 
          RowBox[{"PrecisionGoal", "->", "10"}], ",", 
          RowBox[{"MaxIterations", "->", "200"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Omega]", "/.", " ", "sol"}]}]}], "]"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SuperradianceRate", "[", 
     RowBox[{
     "l_", ",", "m_", ",", "M_", ",", "aTilde_", ",", "\[Mu]_", ",", 
      "\[Omega]Guess_", ",", 
      RowBox[{"Nmax_", ":", "100"}], ",", 
      RowBox[{"prec_", ":", "60"}]}], "]"}], ":=", 
    RowBox[{"Im", "@", 
     RowBox[{"SuperradiantMode", "[", 
      RowBox[{
      "l", ",", "m", ",", "M", ",", "aTilde", ",", "\[Mu]", ",", 
       "\[Omega]Guess", ",", "Nmax", ",", "prec"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", "Example", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M", "=", "1"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"aTilde", "=", "0.99"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Mu]", "=", "0.4"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"l", "=", "1"}], ";", 
  RowBox[{"m", "=", "1"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Omega]Guess", "=", 
    RowBox[{"0.39", "+", 
     RowBox[{
      RowBox[{"10", "^", 
       RowBox[{"-", "6"}]}], " ", "I"}]}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{"SuperradianceRate", "[", 
  RowBox[{
  "l", ",", "m", ",", "M", ",", "aTilde", ",", "\[Mu]", ",", "\[Omega]Guess", 
   ",", "100", ",", "300"}], "]"}]}], "Input",
 CellChangeTimes->{{3.980331399828003*^9, 3.980331449241604*^9}},
 CellLabel->
  "In[546]:=",ExpressionUUID->"02ebc508-5596-4a4f-b96d-8f22f96a79f6"]
},
WindowSize->{718.5, 729.75},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
FrontEndVersion->"14.2 for Microsoft Windows (64-bit) (March 14, 2025)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"76ce2630-c926-a74b-99f1-bd6724b2afc0"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[554, 20, 18872, 534, 1645, "Input",ExpressionUUID->"02ebc508-5596-4a4f-b96d-8f22f96a79f6"]
}
]
*)

